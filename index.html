<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FisherMN - Command Center</title>
  <link rel="stylesheet" href="/css/tailwind.css">
  <script src="https://unpkg.com/htmx.org@1.9.10"></script>
  <script src="/js/navigation.js"></script>
  <script src="/js/auth.js"></script>
  <script src="/js/ui-controller.js"></script>
  <script src="/js/auth-modal.js"></script>
</head>
<body class="bg-frost">
  <!-- Anti-FOUC Script -->
  <script>
    (function() {
      const isLoggedIn = !!localStorage.getItem('fishermn_auth_token');
      const currentPath = window.location.pathname;

      if (!isLoggedIn) {
        if (currentPath === '/' || currentPath === '/index.html') {
          window.location.replace('/lakes.html');
        }
      }
    })();
  </script>

  <!-- Auth Modal Loader -->
  <div hx-get="/partials/auth-modal.html" hx-trigger="load" hx-swap="beforeend"></div>

  <!-- Left Sidebar -->
  <div hx-get="/partials/sidebar-nav.html" hx-trigger="load" hx-swap="outerHTML"></div>

  <!-- Top Bar -->
  <div hx-get="/partials/top-bar.html" hx-trigger="load" hx-swap="outerHTML"></div>

  <!-- Main Content Area -->
  <main class="ml-64 mt-16 p-6 min-h-screen">
    <!-- Top Stats Row -->
    <div class="grid grid-cols-5 gap-4 mb-6">
      <!-- Rank Card -->
      <div class="card bg-gradient-to-br from-primary to-evergreen text-white col-span-2">
        <div class="flex items-center justify-between">
          <div class="flex items-center gap-3">
            <svg class="w-12 h-12 text-gold" fill="currentColor" viewBox="0 0 20 20">
              <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"></path>
            </svg>
            <div>
              <p class="text-2xl font-bold">Local Legend Silver</p>
              <p class="text-ice">Level 11 ‚Ä¢ ‚òÖ‚òÖ‚òÖ‚òÖ‚òÜ 4.7</p>
            </div>
          </div>
          <div class="text-right">
            <p class="text-3xl font-bold text-gold">980</p>
            <p class="text-ice text-sm">XP</p>
          </div>
        </div>
      </div>

      <!-- Quick Stats -->
      <div class="card text-center">
        <p class="text-3xl font-bold text-primary">34</p>
        <p class="text-xs text-secondary mt-1">Ice Reports</p>
      </div>
      <div class="card text-center">
        <p class="text-3xl font-bold text-primary">28</p>
        <p class="text-xs text-secondary mt-1">Catch Reports</p>
      </div>
      <div class="card text-center">
        <p class="text-3xl font-bold text-evergreen">8</p>
        <p class="text-xs text-secondary mt-1">Lakes Visited</p>
      </div>
    </div>

    <!-- XP Progress Bar -->
    <div class="card mb-6">
      <div class="flex items-center gap-4">
        <div class="flex-1">
          <div class="flex justify-between items-center mb-2">
            <span class="text-sm font-semibold">Progress to Local Legend Gold</span>
            <span class="text-sm text-secondary">980 / 1,100 XP</span>
          </div>
          <div class="w-full bg-grayPanel rounded-full h-3">
            <div class="bg-gradient-to-r from-gold to-primary h-full rounded-full" style="width: 89%"></div>
          </div>
        </div>
        <div class="text-right">
          <p class="text-2xl font-bold text-gold">120</p>
          <p class="text-xs text-secondary">XP to go</p>
        </div>
      </div>
    </div>

    <!-- Three Column Layout -->
    <div class="grid grid-cols-3 gap-6">
      <!-- Left Column: My Favorite Lakes -->
      <div class="space-y-4">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-lg font-bold">My Favorite Lakes</h2>
          <button class="text-xs text-primary hover:text-evergreen font-medium">Manage</button>
        </div>

        <div class="card hover:shadow-lg transition-all cursor-pointer">
          <div class="flex justify-between items-start mb-2">
            <div>
              <h3 class="font-bold">Mille Lacs Lake</h3>
              <p class="text-xs text-secondary">Central MN</p>
            </div>
            <span class="badge bg-gold text-white text-xs">Good Ice</span>
          </div>
          <div class="text-xs text-secondary space-y-1">
            <p>‚Ä¢ 10" avg thickness</p>
            <p>‚Ä¢ 24 reports today</p>
            <p>‚Ä¢ üç∫ 4 bars ‚Ä¢ üé£ 3 bait shops ‚Ä¢ üé∞ casino</p>
          </div>
        </div>

        <div class="card hover:shadow-lg transition-all cursor-pointer">
          <div class="flex justify-between items-start mb-2">
            <div>
              <h3 class="font-bold">Upper Red Lake</h3>
              <p class="text-xs text-secondary">Northern MN</p>
            </div>
            <span class="badge bg-evergreen text-white text-xs">Excellent</span>
          </div>
          <div class="text-xs text-secondary space-y-1">
            <p>‚Ä¢ 14" avg thickness</p>
            <p>‚Ä¢ 12 reports today</p>
            <p>‚Ä¢ üç∫ 3 bars ‚Ä¢ üé£ 3 bait shops</p>
          </div>
        </div>

        <div class="card hover:shadow-lg transition-all cursor-pointer">
          <div class="flex justify-between items-start mb-2">
            <div>
              <h3 class="font-bold">Lake of the Woods</h3>
              <p class="text-xs text-secondary">Northern MN</p>
            </div>
            <span class="badge bg-evergreen text-white text-xs">Excellent</span>
          </div>
          <div class="text-xs text-secondary space-y-1">
            <p>‚Ä¢ 16" avg thickness</p>
            <p>‚Ä¢ 18 reports today</p>
            <p>‚Ä¢ üç∫ 4 bars ‚Ä¢ üé£ 2 bait shops ‚Ä¢ üé∞ casino</p>
          </div>
        </div>

        <!-- Quick Actions -->
        <div class="card bg-gold/5 border-gold">
          <h3 class="font-bold text-sm mb-3">üèÜ Season Challenge</h3>
          <p class="text-xs text-secondary mb-2">Top 10 contributors win $500 Scheels gift card</p>
          <div class="flex items-center justify-between">
            <span class="text-xs text-secondary">Your rank:</span>
            <span class="font-bold text-primary">#11 of 847</span>
          </div>
        </div>
      </div>

      <!-- Middle Column: Live Activity Feed -->
      <div>
        <div class="flex items-center justify-between mb-4">
          <h2 class="text-lg font-bold">Live Activity Feed</h2>
          <button class="text-xs text-primary hover:text-evergreen font-medium">View All</button>
        </div>

        <div class="space-y-3">
          <!-- Report 1 -->
          <div class="card hover:shadow-md transition-all border-l-4 border-l-evergreen">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold">IM</div>
                <div>
                  <p class="font-semibold text-sm">IceMaster99</p>
                  <p class="text-xs text-secondary">State Legend ‚Ä¢ 5min ago</p>
                </div>
              </div>
              <span class="text-xs px-2 py-1 bg-evergreen/10 text-evergreen rounded font-medium">ICE</span>
            </div>
            <div class="text-sm">
              <p class="font-medium mb-1">üìç Upper Red Lake - NW</p>
              <p class="text-secondary text-xs">14" thickness ‚Ä¢ Good quality ‚Ä¢ Safe to drive</p>
            </div>
            <div class="flex gap-3 mt-2 text-xs">
              <button class="text-secondary hover:text-primary">üëç 23</button>
              <button class="text-secondary hover:text-primary">üí¨ 5</button>
            </div>
          </div>

          <!-- Report 2 -->
          <div class="card hover:shadow-md transition-all border-l-4 border-l-gold">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-gold rounded-full flex items-center justify-center text-white text-xs font-bold">WH</div>
                <div>
                  <p class="font-semibold text-sm">WalleyeHunter</p>
                  <p class="text-xs text-secondary">Lake Captain ‚Ä¢ 15min ago</p>
                </div>
              </div>
              <span class="text-xs px-2 py-1 bg-gold/10 text-gold rounded font-medium">CATCH</span>
            </div>
            <div class="text-sm">
              <p class="font-medium mb-1">üìç Upper Red Lake - NE</p>
              <p class="text-secondary text-xs">3 Walleye ‚Ä¢ Biggest 24" ‚Ä¢ Mid depth</p>
            </div>
            <div class="flex gap-3 mt-2 text-xs">
              <button class="text-secondary hover:text-primary">üëç 15</button>
              <button class="text-secondary hover:text-primary">üí¨ 3</button>
            </div>
          </div>

          <!-- Report 3 -->
          <div class="card hover:shadow-md transition-all border-l-4 border-l-purple-500">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold">FD</div>
                <div>
                  <p class="font-semibold text-sm">You</p>
                  <p class="text-xs text-secondary">Local Legend ‚Ä¢ 2hrs ago</p>
                </div>
              </div>
              <span class="text-xs px-2 py-1 bg-gold/10 text-gold rounded font-medium">CATCH</span>
            </div>
            <div class="text-sm">
              <p class="font-medium mb-1">üìç Mille Lacs Lake - SW</p>
              <p class="text-secondary text-xs">2 Northern Pike ‚Ä¢ Biggest 28" ‚Ä¢ Shallow</p>
            </div>
            <div class="flex gap-3 mt-2 text-xs">
              <button class="text-secondary hover:text-primary">üëç 9</button>
              <button class="text-secondary hover:text-primary">üí¨ 2</button>
            </div>
          </div>

          <!-- Report 4 -->
          <div class="card hover:shadow-md transition-all border-l-4 border-l-evergreen">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white text-xs font-bold">LE</div>
                <div>
                  <p class="font-semibold text-sm">LOTWExpert</p>
                  <p class="text-xs text-secondary">State Legend ‚Ä¢ 4hrs ago</p>
                </div>
              </div>
              <span class="text-xs px-2 py-1 bg-evergreen/10 text-evergreen rounded font-medium">ICE</span>
            </div>
            <div class="text-sm">
              <p class="font-medium mb-1">üìç Lake of the Woods - Whole Lake</p>
              <p class="text-secondary text-xs">16" thickness ‚Ä¢ Excellent ‚Ä¢ Safe for trucks</p>
            </div>
            <div class="flex gap-3 mt-2 text-xs">
              <button class="text-secondary hover:text-primary">üëç 34</button>
              <button class="text-secondary hover:text-primary">üí¨ 8</button>
            </div>
          </div>

          <!-- Report 5 -->
          <div class="card hover:shadow-md transition-all border-l-4 border-l-gold">
            <div class="flex items-start justify-between mb-2">
              <div class="flex items-center gap-2">
                <div class="w-8 h-8 bg-purple-500 rounded-full flex items-center justify-center text-white text-xs font-bold">CK</div>
                <div>
                  <p class="font-semibold text-sm">CrappieKing</p>
                  <p class="text-xs text-secondary">Local Legend ‚Ä¢ 6hrs ago</p>
                </div>
              </div>
              <span class="text-xs px-2 py-1 bg-gold/10 text-gold rounded font-medium">CATCH</span>
            </div>
            <div class="text-sm">
              <p class="font-medium mb-1">üìç Lake of the Woods - SE</p>
              <p class="text-secondary text-xs">8 Crappie ‚Ä¢ Biggest 12" ‚Ä¢ Deep water</p>
            </div>
            <div class="flex gap-3 mt-2 text-xs">
              <button class="text-secondary hover:text-primary">üëç 18</button>
              <button class="text-secondary hover:text-primary">üí¨ 4</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Right Column: Today's Conditions & Top Contributors -->
      <div class="space-y-4">
        <div class="flex items-center justify-between mb-2">
          <h2 class="text-lg font-bold">Today's Conditions</h2>
        </div>

        <div class="card">
          <div class="flex items-center justify-between mb-3">
            <h3 class="font-bold text-sm">Ice Safety Summary</h3>
            <span class="text-xs text-evergreen font-medium">Updated 5min ago</span>
          </div>
          <div class="space-y-2">
            <div class="flex items-center justify-between text-sm">
              <span class="text-secondary">Excellent (15"+)</span>
              <span class="font-bold text-evergreen">4 lakes</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span class="text-secondary">Good (10-15")</span>
              <span class="font-bold text-gold">3 lakes</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span class="text-secondary">Fair (8-10")</span>
              <span class="font-bold text-secondary">2 lakes</span>
            </div>
            <div class="flex items-center justify-between text-sm">
              <span class="text-secondary">Marginal (<8")</span>
              <span class="font-bold text-danger">1 lake</span>
            </div>
          </div>
        </div>

        <div class="card">
          <h3 class="font-bold text-sm mb-3">üå°Ô∏è Weather Alert</h3>
          <p class="text-xs text-secondary mb-2">Warming trend this weekend</p>
          <div class="text-xs space-y-1">
            <p>‚Ä¢ Sat: 28¬∞F ‚Üí Ice conditions stable</p>
            <p>‚Ä¢ Sun: 35¬∞F ‚Üí Monitor for slush</p>
            <p class="text-danger font-medium">‚ö†Ô∏è Check ice before heading out</p>
          </div>
        </div>

        <div>
          <h3 class="font-bold text-sm mb-3">üèÜ Top Contributors Today</h3>
          <div class="space-y-2">
            <div class="card py-2">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <span class="text-gold font-bold text-sm">ü•á</span>
                  <div>
                    <p class="text-xs font-semibold">IceMaster99</p>
                    <p class="text-xs text-secondary">8 reports</p>
                  </div>
                </div>
                <span class="text-xs text-gold font-bold">+160 XP</span>
              </div>
            </div>
            <div class="card py-2">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <span class="text-gray-400 font-bold text-sm">ü•à</span>
                  <div>
                    <p class="text-xs font-semibold">WalleyeHunter</p>
                    <p class="text-xs text-secondary">6 reports</p>
                  </div>
                </div>
                <span class="text-xs text-gold font-bold">+120 XP</span>
              </div>
            </div>
            <div class="card py-2">
              <div class="flex items-center justify-between">
                <div class="flex items-center gap-2">
                  <span class="text-amber-600 font-bold text-sm">ü•â</span>
                  <div>
                    <p class="text-xs font-semibold">LOTWExpert</p>
                    <p class="text-xs text-secondary">5 reports</p>
                  </div>
                </div>
                <span class="text-xs text-gold font-bold">+100 XP</span>
              </div>
            </div>
          </div>
        </div>

        <div class="card bg-primary text-white">
          <h3 class="font-bold text-sm mb-2">Quick Actions</h3>
          <div class="space-y-2 text-xs">
            <button onclick="openReportModal('ice')" class="w-full py-2 bg-white/10 hover:bg-white/20 rounded transition-all font-medium">+ Submit Ice Report</button>
            <button onclick="openReportModal('catch')" class="w-full py-2 bg-white/10 hover:bg-white/20 rounded transition-all font-medium">+ Submit Catch</button>
            <button onclick="openReportModal('checkin')" class="w-full py-2 bg-white/10 hover:bg-white/20 rounded transition-all font-medium">Check-in at Business</button>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Report Modal -->
  <div id="report-modal" class="hidden fixed inset-0 z-50">
    <!-- Backdrop -->
    <div class="absolute inset-0 bg-black/50" onclick="closeReportModal()"></div>

    <!-- Modal Content -->
    <div class="absolute bottom-0 left-0 right-0 bg-white rounded-t-2xl max-h-[85vh] overflow-y-auto transform transition-transform duration-300">
      <!-- Header -->
      <div class="sticky top-0 bg-white border-b border-grayPanel px-6 py-4 flex items-center justify-between">
        <h2 id="modal-title" class="text-xl font-bold">Submit Report</h2>
        <button onclick="closeReportModal()" class="text-secondary hover:text-primary p-2">
          <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
          </svg>
        </button>
      </div>

      <!-- Tab Buttons -->
      <div class="flex border-b border-grayPanel bg-frost">
        <button id="tab-ice" onclick="switchReportTab('ice')" class="flex-1 py-3 text-sm font-semibold text-center border-b-2 border-primary text-primary">
          Ice Report
        </button>
        <button id="tab-catch" onclick="switchReportTab('catch')" class="flex-1 py-3 text-sm font-semibold text-center border-b-2 border-transparent text-secondary hover:text-primary">
          Catch Report
        </button>
        <button id="tab-checkin" onclick="switchReportTab('checkin')" class="flex-1 py-3 text-sm font-semibold text-center border-b-2 border-transparent text-secondary hover:text-primary">
          Check-in
        </button>
      </div>

      <!-- Ice Report Form -->
      <div id="form-ice" class="p-6 space-y-4">
        <div>
          <label class="block text-sm font-medium mb-2">Select Lake</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Choose a lake...</option>
            <option value="upper-red-lake">Upper Red Lake</option>
            <option value="lake-of-the-woods">Lake of the Woods</option>
            <option value="mille-lacs">Mille Lacs Lake</option>
            <option value="leech-lake">Leech Lake</option>
            <option value="winnibigoshish">Lake Winnibigoshish</option>
            <option value="vermilion">Lake Vermilion</option>
            <option value="gull-lake">Gull Lake</option>
            <option value="rainy-lake">Rainy Lake</option>
            <option value="otter-tail">Otter Tail Lake</option>
            <option value="cass-lake">Cass Lake</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Location on Lake</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Select quadrant...</option>
            <option value="NW">Northwest (NW)</option>
            <option value="NE">Northeast (NE)</option>
            <option value="SW">Southwest (SW)</option>
            <option value="SE">Southeast (SE)</option>
            <option value="WHOLE_LAKE">Whole Lake</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Ice Thickness (inches)</label>
          <input type="number" min="0" max="48" placeholder="e.g., 12" class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary">
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Ice Quality</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Select quality...</option>
            <option value="good">Good - Clear, solid ice</option>
            <option value="fair">Fair - Some slush or cracks</option>
            <option value="poor">Poor - Slush, water pockets</option>
            <option value="dangerous">Dangerous - Unsafe conditions</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Confidence Level</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="high">Very Sure - Drilled/measured</option>
            <option value="medium">Somewhat Sure - Visual estimate</option>
            <option value="low">Rough Estimate</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Notes (optional)</label>
          <textarea rows="3" placeholder="Any additional details about conditions..." class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary resize-none"></textarea>
        </div>

        <div class="border-2 border-dashed border-grayPanel rounded-lg p-6 text-center">
          <span class="text-3xl mb-2 block">üì∑</span>
          <p class="text-sm text-secondary">Photo upload coming soon</p>
        </div>

        <button onclick="submitReport('ice')" class="w-full py-4 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors">
          Submit Ice Report (+20 XP)
        </button>
      </div>

      <!-- Catch Report Form -->
      <div id="form-catch" class="p-6 space-y-4 hidden">
        <div>
          <label class="block text-sm font-medium mb-2">Select Lake</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Choose a lake...</option>
            <option value="upper-red-lake">Upper Red Lake</option>
            <option value="lake-of-the-woods">Lake of the Woods</option>
            <option value="mille-lacs">Mille Lacs Lake</option>
            <option value="leech-lake">Leech Lake</option>
            <option value="winnibigoshish">Lake Winnibigoshish</option>
            <option value="vermilion">Lake Vermilion</option>
            <option value="gull-lake">Gull Lake</option>
            <option value="rainy-lake">Rainy Lake</option>
            <option value="otter-tail">Otter Tail Lake</option>
            <option value="cass-lake">Cass Lake</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Species</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Select species...</option>
            <option value="walleye">Walleye</option>
            <option value="crappie">Crappie</option>
            <option value="perch">Perch</option>
            <option value="northern-pike">Northern Pike</option>
            <option value="muskie">Muskie</option>
            <option value="smallmouth-bass">Smallmouth Bass</option>
            <option value="largemouth-bass">Largemouth Bass</option>
            <option value="bluegill">Bluegill</option>
            <option value="other">Other</option>
          </select>
        </div>

        <div class="grid grid-cols-2 gap-4">
          <div>
            <label class="block text-sm font-medium mb-2">Length (inches)</label>
            <input type="number" min="0" max="60" placeholder="e.g., 18" class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary">
          </div>
          <div>
            <label class="block text-sm font-medium mb-2">Count</label>
            <input type="number" min="1" max="100" placeholder="e.g., 5" class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary">
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Location on Lake</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Select quadrant...</option>
            <option value="NW">Northwest (NW)</option>
            <option value="NE">Northeast (NE)</option>
            <option value="SW">Southwest (SW)</option>
            <option value="SE">Southeast (SE)</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Depth</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Select depth...</option>
            <option value="shallow">Shallow (&lt;10 ft)</option>
            <option value="mid">Mid (10-20 ft)</option>
            <option value="deep">Deep (20+ ft)</option>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Lure/Bait (optional)</label>
          <input type="text" placeholder="e.g., Jigging Rapala, minnow" class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary">
        </div>

        <button onclick="submitReport('catch')" class="w-full py-4 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors">
          Submit Catch Report (+15 XP)
        </button>
      </div>

      <!-- Check-in Form -->
      <div id="form-checkin" class="p-6 space-y-4 hidden">
        <div>
          <label class="block text-sm font-medium mb-2">Select Business</label>
          <select class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary bg-white">
            <option value="">Choose a business...</option>
            <optgroup label="Upper Red Lake">
              <option value="red-lake-bait">Red Lake Bait & Tackle</option>
              <option value="rocky-reef-bar">Rocky Reef Bar</option>
              <option value="ice-shack-pub">The Ice Shack Pub</option>
            </optgroup>
            <optgroup label="Mille Lacs Lake">
              <option value="grand-casino">Grand Casino Mille Lacs</option>
              <option value="twin-pines-bar">Twin Pines Bar</option>
              <option value="mille-lacs-bait">Mille Lacs Bait</option>
            </optgroup>
            <optgroup label="Lake of the Woods">
              <option value="sportsmans-casino">Sportsman's Casino</option>
              <option value="freeze-bar">The Freeze Bar</option>
              <option value="border-bait">Border Bait Co</option>
            </optgroup>
          </select>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Rating</label>
          <div class="flex gap-2">
            <button onclick="setRating(1)" class="rating-star text-3xl text-grayPanel hover:text-gold transition-colors">‚òÖ</button>
            <button onclick="setRating(2)" class="rating-star text-3xl text-grayPanel hover:text-gold transition-colors">‚òÖ</button>
            <button onclick="setRating(3)" class="rating-star text-3xl text-grayPanel hover:text-gold transition-colors">‚òÖ</button>
            <button onclick="setRating(4)" class="rating-star text-3xl text-grayPanel hover:text-gold transition-colors">‚òÖ</button>
            <button onclick="setRating(5)" class="rating-star text-3xl text-grayPanel hover:text-gold transition-colors">‚òÖ</button>
          </div>
        </div>

        <div>
          <label class="block text-sm font-medium mb-2">Notes (optional)</label>
          <textarea rows="3" placeholder="How was your experience?" class="w-full px-4 py-3 rounded-lg border border-grayPanel focus:outline-none focus:ring-2 focus:ring-primary resize-none"></textarea>
        </div>

        <div class="p-4 bg-frost rounded-lg">
          <p class="text-sm text-secondary mb-2">üìç GPS verification will be required</p>
          <p class="text-xs text-muted">Check-ins within 500ft of the business location earn bonus XP</p>
        </div>

        <button onclick="submitReport('checkin')" class="w-full py-4 bg-primary text-white font-bold rounded-lg hover:bg-primary/90 transition-colors">
          Check In (+10 XP)
        </button>
      </div>
    </div>
  </div>

  <!-- Toast Notification -->
  <div id="toast" class="hidden fixed bottom-6 left-1/2 transform -translate-x-1/2 bg-evergreen text-white px-6 py-3 rounded-lg shadow-lg z-50 flex items-center gap-3">
    <span class="text-xl">‚úì</span>
    <span id="toast-message">Report submitted!</span>
  </div>

  <script>
    // Modal functions
    function openReportModal(tab = 'ice') {
      document.getElementById('report-modal').classList.remove('hidden');
      switchReportTab(tab);
      document.body.style.overflow = 'hidden';
    }

    function closeReportModal() {
      document.getElementById('report-modal').classList.add('hidden');
      document.body.style.overflow = '';
    }

    function switchReportTab(tab) {
      // Update tab buttons
      ['ice', 'catch', 'checkin'].forEach(t => {
        const tabBtn = document.getElementById(`tab-${t}`);
        const form = document.getElementById(`form-${t}`);

        if (t === tab) {
          tabBtn.classList.add('border-primary', 'text-primary');
          tabBtn.classList.remove('border-transparent', 'text-secondary');
          form.classList.remove('hidden');
        } else {
          tabBtn.classList.remove('border-primary', 'text-primary');
          tabBtn.classList.add('border-transparent', 'text-secondary');
          form.classList.add('hidden');
        }
      });

      // Update modal title
      const titles = {
        ice: 'Submit Ice Report',
        catch: 'Submit Catch Report',
        checkin: 'Check-in at Business'
      };
      document.getElementById('modal-title').textContent = titles[tab];
    }

    // Rating stars
    let currentRating = 0;
    function setRating(rating) {
      currentRating = rating;
      const stars = document.querySelectorAll('.rating-star');
      stars.forEach((star, index) => {
        if (index < rating) {
          star.classList.add('text-gold');
          star.classList.remove('text-grayPanel');
        } else {
          star.classList.remove('text-gold');
          star.classList.add('text-grayPanel');
        }
      });
    }

    // Submit report
    function submitReport(type) {
      closeReportModal();

      const xpAmounts = {
        ice: 20,
        catch: 15,
        checkin: 10
      };

      const typeNames = {
        ice: 'Ice Report',
        catch: 'Catch Report',
        checkin: 'Check-in'
      };

      showToast(`${typeNames[type]} submitted! +${xpAmounts[type]} XP`);
    }

    // Toast notification
    function showToast(message) {
      const toast = document.getElementById('toast');
      document.getElementById('toast-message').textContent = message;
      toast.classList.remove('hidden');

      setTimeout(() => {
        toast.classList.add('hidden');
      }, 3000);
    }

    // Close modal on escape key
    document.addEventListener('keydown', (e) => {
      if (e.key === 'Escape') {
        closeReportModal();
      }
    });
  </script>
</body>
</html>
